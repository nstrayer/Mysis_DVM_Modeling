axis(side = 2, col = "white", tcl = 0)
windowsFonts(
A=windowsFont("Arial Black"),
B=windowsFont("Bookman Old Style"),
C=windowsFont("Comic Sans MS"),
D=windowsFont("Symbol")
)
lightAtNoon = lightLevels[seq(12, length(lightLevels), 24)]
plot(lightAtNoon, type = "l", main = "Burlington Light Levels at Mid-Day for 1991", xlab = "Day of Year", ylab = "Light Levels in Wh/m^2")
lines(smooth.spline(lightAtNoon), col = "blue", lw = 4)
axis(side = 1)
axis(side = 1, col = "white", tcl = 0)
axis(side = 2)
axis(side = 2, col = "white", tcl = 0)
png("noonLightLevels.png")
lightAtNoon = lightLevels[seq(12, length(lightLevels), 24)]
plot(lightAtNoon, type = "l", main = "Burlington Light Levels at Mid-Day for 1991", xlab = "Day of Year", ylab = "Light Levels in Wh/m^2")
lines(smooth.spline(lightAtNoon), col = "blue", lw = 4)
axis(side = 1)
axis(side = 1, col = "white", tcl = 0)
axis(side = 2)
axis(side = 2, col = "white", tcl = 0)
plot(-depthData[seq(12, length(lightLevels), 24)], type = "l", width = 3, frame.plot=T,axes=FALSE,
main = "Depth of 10 degrees centegrade from Surface",
xlab = "Day of Year",
ylab = "Depth from Water Surface")
axis(side = 1)
axis(side = 1, col = "white", tcl = 0)
axis(side = 2)
axis(side = 2, col = "white", tcl = 0)
lightDepth = function(surfaceLight){
#First we will set constants. These will most likely be toggled.
k   = 0.3  #extinction coefficient
I_x = 0.001 #Mysis light threshold (paper quotes between 10^-2 and 10^-4)
distance = (1/k) * (log(surfaceLight) - log(I_x))
return(distance)
}
#30 day cycle
#days = 1:30
days = 1:365
#Nightime light level in lux
lightLevel = NULL
for (day in days){
cyclePoint = day %% 30
lightLevel = c(lightLevel, 0.5 * cos((1/30)* 2*pi * cyclePoint ) + .5)
}
#Check to see if this is functional
plot(days, lightLevel, type = "l")
plot(days, isocline, type = "l")
axis(side = 1)
axis(side = 1, col = "white", tcl = 0)
axis(side = 2)
axis(side = 2, col = "white", tcl = 0)
lightDepth = function(surfaceLight){
#First we will set constants. These will most likely be toggled.
k   = 0.3  #extinction coefficient
I_x = 0.001 #Mysis light threshold (paper quotes between 10^-2 and 10^-4)
distance = (1/k) * (log(surfaceLight) - log(I_x))
return(distance)
}
#30 day cycle
#days = 1:30
days = 1:365
#Nightime light level in lux
lightLevel = NULL
for (day in days){
cyclePoint = day %% 30
lightLevel = c(lightLevel, 0.5 * cos((1/30)* 2*pi * cyclePoint ) + .5)
}
#Check to see if this is functional
plot(days, lightLevel, type = "l")
plot(days, lightLevel, type = "l")
axis(side = 1)
axis(side = 1, col = "white", tcl = 0)
axis(side = 2)
axis(side = 2, col = "white", tcl = 0)
lightLevel = NULL
for (day in days){
cyclePoint = day %% 27
lightLevel = c(lightLevel, 0.5 * cos((1/27)* 2*pi * cyclePoint ) + .5)
}
#Check to see if this is functional
plot(days, lightLevel, type = "l"
main = "Light Levels at Midnight (Moon Cycle)")
axis(side = 1)
axis(side = 1, col = "white", tcl = 0)
axis(side = 2)
axis(side = 2, col = "white", tcl = 0)
lightLevel = NULL
for (day in days){
cyclePoint = day %% 27
lightLevel = c(lightLevel, 0.5 * cos((1/27)* 2*pi * cyclePoint ) + .5)
}
#Check to see if this is functional
plot(days, lightLevel, type = "l"
main = "Light Levels at Midnight (Moon Cycle)")
axis(side = 1)
axis(side = 1, col = "white", tcl = 0)
axis(side = 2)
axis(side = 2, col = "white", tcl = 0)
lightLevel = NULL
for (day in days){
cyclePoint = day %% 27
lightLevel = c(lightLevel, 0.5 * cos((1/27)* 2*pi * cyclePoint ) + .5)
}
#Check to see if this is functional
plot(days, lightLevel, type = "l",
main = "Light Levels at Midnight (Moon Cycle)")
axis(side = 1)
axis(side = 1, col = "white", tcl = 0)
axis(side = 2)
axis(side = 2, col = "white", tcl = 0)
plot(days, lightLevel, type = "l",
main = "Light Levels at Midnight (Moon Cycle)",
xlab = "Day of Year",
ylab = "Light Level in Lumens")
axis(side = 1)
axis(side = 1, col = "white", tcl = 0)
axis(side = 2)
axis(side = 2, col = "white", tcl = 0)
setwd("/Users/Nick/mysisModeling")
# Thus begins the mysis model.
# Functions that drive the model are written in the form Foo_Foo
# Variables that go into the model are writtenin camelCase. E.g. fooFoo.
#Let's bring in the thermocline depth data
#---------------------------------------------------------------------------------------------
#Bringing in outside data:
#---------------------------------------------------------------------------------------------
depthData = read.csv("thermoclineDepths.csv")$dist
plot(-depthData[seq(12, length(lightLevels), 24)], type = "l", width = 3, frame.plot=T,axes=FALSE,
main = "Depth of 10 degrees centegrade from Surface",
xlab = "Day of Year",
ylab = "Depth from Water Surface")
axis(side = 1)
axis(side = 1, col = "white", tcl = 0)
axis(side = 2)
axis(side = 2, col = "white", tcl = 0)
#---------------------------------------------------------------------------------------------
#Depth of light threshold function:
#---------------------------------------------------------------------------------------------
lightDepth = function(surfaceLight){
#First we will set constants. These will most likely be toggled.
k   = 0.3  #extinction coefficient
I_x = 0.001 #Mysis light threshold (paper quotes between 10^-2 and 10^-4)
distance = (1/k) * (log(surfaceLight) - log(I_x))
return(distance)
}
#30 day cycle
#days = 1:30
days = 1:365
#Nightime light level in lux
lightLevel = NULL
for (day in days){
cyclePoint = day %% 27
lightLevel = c(lightLevel, 0.5 * cos((1/27)* 2*pi * cyclePoint ) + .5)
}
#Check to see if this is functional
plot(days, lightLevel, type = "l",
main = "Light Levels at Midnight (Moon Cycle)",
xlab = "Day of Year",
ylab = "Light Level in Lumens")
axis(side = 1)
axis(side = 1, col = "white", tcl = 0)
axis(side = 2)
axis(side = 2, col = "white", tcl = 0)
#Now we will run our light depth function over this:
isocline = NULL
for (day in lightLevel){
if (day == 0){
isocline = c(isocline, 0) #logs dont play nice with 0s
} else {
isocline = c(isocline, lightDepth(day))
}
}
#Check to see if this is functional
plot(days, isocline, type = "l")
axis(side = 1)
axis(side = 1, col = "white", tcl = 0)
axis(side = 2)
axis(side = 2, col = "white", tcl = 0)
#Now let's grab some of our depth data real quick:
smallDepthData = NULL
for (i in seq(1,24*365, 24)){
smallDepthData = c(smallDepthData, depthData[i])
}
#plot it!
plot(days, -smallDepthData , type = "l", ylab = "isocline depth", main = "Mysis light threshold")
lines(days, -isocline)
#plot it!
plot(days, -smallDepthData , type = "l", ylab = "isocline depth", main = "Mysis light threshold")
lines(days, -isocline)
axis(side = 1)
axis(side = 1, col = "white", tcl = 0)
axis(side = 2)
axis(side = 2, col = "white", tcl = 0)
for ( in in 1:365){
print(i)
}
for ( in in 1:365){
print(i)
}
for (i in in 1:365){
print(i)
}
for (i in in 1:365){
print(i)
}
for (i in in 1:365){
print(i)
}
for (i in in 1:365){
print(i)
}
for (i in in 1:365){
print(i)
}
for (i in 1:365){
print(i)
}
depthLimit = NULL
for (i in 1:365){
if (smallDepthData[i] > isocline){
depthLimit = c(depthLimit, smallDepthData[i])
} else {
depthLimit = c(depthLimit, isocline[i])
}
}
depthLimit = NULL
for (i in 1:365){
if (smallDepthData[i] > isocline){
depthLimit = c(depthLimit, smallDepthData[i])
} else {
depthLimit = c(depthLimit, isocline[i])
}
}
warnings()
depthLimit = NULL
for (i in 1:365){
if (smallDepthData[i] > isocline[i]){
depthLimit = c(depthLimit, smallDepthData[i])
} else {
depthLimit = c(depthLimit, isocline[i])
}
}
#plot it!
plot(days, -depthLimit , type = "l", ylab = "isocline depth", main = "Mysis light threshold")
#lines(days, -isocline)
axis(side = 1)
axis(side = 1, col = "white", tcl = 0)
axis(side = 2)
axis(side = 2, col = "white", tcl = 0)
plot(days, -depthLimit , type = "l",
main = "Mysis light threshold",
ylab = "Depth from Surface",
xlab = "Day of Year")
#lines(days, -isocline)
axis(side = 1)
axis(side = 1, col = "white", tcl = 0)
axis(side = 2)
axis(side = 2, col = "white", tcl = 0)
#plot it!
plot(days, -depthLimit , type = "l", ylim = [5,-40],
main = "Mysis light threshold",
ylab = "Depth from Surface",
xlab = "Day of Year")
#lines(days, -isocline)
axis(side = 1)
axis(side = 1, col = "white", tcl = 0)
axis(side = 2)
axis(side = 2, col = "white", tcl = 0)
#plot it!
plot(days, -depthLimit , type = "l", ylim = c(5,-40),
main = "Mysis light threshold",
ylab = "Depth from Surface",
xlab = "Day of Year")
#lines(days, -isocline)
axis(side = 1)
axis(side = 1, col = "white", tcl = 0)
axis(side = 2)
axis(side = 2, col = "white", tcl = 0)
#plot it!
plot(days, -depthLimit , type = "l", ylim = c(-40,5),
main = "Mysis light threshold",
ylab = "Depth from Surface",
xlab = "Day of Year")
#lines(days, -isocline)
axis(side = 1)
axis(side = 1, col = "white", tcl = 0)
axis(side = 2)
axis(side = 2, col = "white", tcl = 0)
suface = list(rep(0, 365))
lines(suface)
lines(days,suface)
suface = as.list(rep(0, 365))
lines(days,suface)
polygon(days,suface, border=NA, col="blue")
suface = as.list(rep(0, 365))
#plot it!
plot(days, -depthLimit , type = "l", ylim = c(-40,5),
main = "Mysis light threshold",
ylab = "Depth from Surface",
xlab = "Day of Year")
#lines(days, -isocline)
axis(side = 1)
axis(side = 1, col = "white", tcl = 0)
axis(side = 2)
axis(side = 2, col = "white", tcl = 0)
lines(days,suface)
polygon(days,suface, border=NA, col="blue")
polygon(x = days, y = suface, border=NA, col="blue")
?polygon
#plot it!
plot(days, -depthLimit , type = "l", ylim = c(-40,5),
main = "Mysis light threshold",
ylab = "Depth from Surface",
xlab = "Day of Year")
#lines(days, -isocline)
axis(side = 1)
axis(side = 1, col = "white", tcl = 0)
axis(side = 2)
axis(side = 2, col = "white", tcl = 0)
lines(days,suface)
polygon(days,suface,col="gray")
plot(days, -depthLimit , type = "l", ylim = c(-40,5),
main = "Mysis light threshold",
ylab = "Depth from Surface",
xlab = "Day of Year")
#lines(days, -isocline)
axis(side = 1)
axis(side = 1, col = "white", tcl = 0)
axis(side = 2)
axis(side = 2, col = "white", tcl = 0)
lines(days,suface)
polygon(days,c(suface,-40),col="gray")
polygon(c(0,0,365,365),c(-40,0,0,-40),col="gray")
polygon(c(0,0,365,365),c(-40,0,0,-40),col="skyblue")
polygon(c(0,0,365,365),c(-40,0,0,-40),col="skyblue")
plot(days, -depthLimit , type = "l", ylim = c(-40,5),
main = "Mysis light threshold",
ylab = "Depth from Surface",
xlab = "Day of Year")
#lines(days, -isocline)
axis(side = 1)
axis(side = 1, col = "white", tcl = 0)
axis(side = 2)
axis(side = 2, col = "white", tcl = 0)
lines(days,suface)
?polygon
plot(days, -depthLimit , type = "l", ylim = c(-40,5),
main = "Mysis light threshold",
ylab = "Depth from Surface",
xlab = "Day of Year")
#lines(days, -isocline)
axis(side = 1)
axis(side = 1, col = "white", tcl = 0)
axis(side = 2)
axis(side = 2, col = "white", tcl = 0)
lines(days,suface)
polygon(c(0,0,365,365),c(-40,0,0,-40),col=rgb(43,140,190,0.5))
polygon(c(0,0,365,365),c(-40,0,0,-40),col=rgb(1, 0, 0,0.5))
plot(days, -depthLimit , type = "l", ylim = c(-40,5),
main = "Mysis light threshold",
ylab = "Depth from Surface",
xlab = "Day of Year")
#lines(days, -isocline)
axis(side = 1)
axis(side = 1, col = "white", tcl = 0)
axis(side = 2)
axis(side = 2, col = "white", tcl = 0)
lines(days,suface)
polygon(c(0,0,365,365),c(-40,0,0,-40),col=rgb(0.1, .5, .7,0.5))
plot(days, -depthLimit , type = "l", ylim = c(-40,5),
main = "Mysis light threshold",
ylab = "Depth from Surface",
xlab = "Day of Year")
#lines(days, -isocline)
axis(side = 1)
axis(side = 1, col = "white", tcl = 0)
axis(side = 2)
axis(side = 2, col = "white", tcl = 0)
lines(days,suface)
polygon(c(0,0,365,365),c(-40,0,0,-40),col=rgb(0.1, .5, .7,0.2))
polygon(c(0,0,365,365),c(-40,0,0,-40),col=rgb(0.1, .7, .7,0.3))
polygon(c(0,0,365,365),c(-45,0,0,-45),col=rgb(0.1, .7, .7,0.3))
suface = as.list(rep(0, 365))
#plot it!
plot(days, -depthLimit , type = "l", ylim = c(-40,5),
main = "Mysis light threshold",
ylab = "Depth from Surface",
xlab = "Day of Year")
#lines(days, -isocline)
axis(side = 1)
axis(side = 1, col = "white", tcl = 0)
axis(side = 2)
axis(side = 2, col = "white", tcl = 0)
lines(days,suface)
polygon(c(0,0,365,365),c(-45,0,0,-45),col=rgb(0.1, .7, .7,0.3))
plot(days, -depthLimit , type = "l", ylim = c(-40,5),
main = "Mysis light threshold",
ylab = "Depth from Surface",
xlab = "Day of Year")
#lines(days, -isocline)
axis(side = 1)
axis(side = 1, col = "white", tcl = 0)
axis(side = 2)
axis(side = 2, col = "white", tcl = 0)
lines(days,suface)
polygon(c(-10,-10,375,375),c(-45,0,0,-45),col=rgb(0.1, .7, .7,0.3))
plot(days, -depthLimit , type = "l", ylim = c(-40,5),
main = "Mysis light threshold",
ylab = "Depth from Surface",
xlab = "Day of Year")
#lines(days, -isocline)
axis(side = 1)
axis(side = 1, col = "white", tcl = 0)
axis(side = 2)
axis(side = 2, col = "white", tcl = 0)
lines(days,suface)
polygon(c(-15,-15,380,380),c(-45,0,0,-45),col=rgb(0.1, .7, .7,0.3))
plot(days, -depthLimit , type = "l", ylim = c(-40,5),
main = "Mysis light threshold",
ylab = "Depth from Surface",
xlab = "Day of Year")
#lines(days, -isocline)
axis(side = 1)
axis(side = 1, col = "white", tcl = 0)
axis(side = 2)
axis(side = 2, col = "white", tcl = 0)
polygon(c(-15,-15,380,380),c(-45,0,0,-45),col=rgb(0.1, .7, .7,0.3))
plot(days, -depthLimit , type = "l", ylim = c(-40,5),
main = "Mysis light threshold",
ylab = "Depth from Surface",
xlab = "Day of Year")
#lines(days, -isocline)
axis(side = 1)
axis(side = 1, col = "white", tcl = 0)
axis(side = 2)
axis(side = 2, col = "white", tcl = 0)
polygon(c(-15,-15,380,380),c(-45,0,0,-45),col=rgb(0.1, .9, .7,0.3))
plot(days, -depthLimit , type = "l", ylim = c(-40,5),
main = "Mysis light threshold",
ylab = "Depth from Surface",
xlab = "Day of Year")
#lines(days, -isocline)
axis(side = 1)
axis(side = 1, col = "white", tcl = 0)
axis(side = 2)
axis(side = 2, col = "white", tcl = 0)
polygon(c(-15,-15,380,380),c(-45,0,0,-45),col=rgb(0.1, .5, .7,0.3))
#plot it!
plot(days, -depthLimit , type = "l", ylim = c(-40,5),
main = "Mysis light threshold",
ylab = "Depth from Surface",
xlab = "Day of Year")
#lines(days, -isocline)
axis(side = 1)
axis(side = 1, col = "white", tcl = 0)
axis(side = 2)
axis(side = 2, col = "white", tcl = 0)
polygon(c(-15,-15,380,380),c(-45,0,0,-45),col=rgb(0.1, .5, .8,0.3))
plot(days, -depthLimit , type = "l", ylim = c(-40,5),
main = "Mysis light threshold",
ylab = "Depth from Surface",
xlab = "Day of Year")
#lines(days, -isocline)
axis(side = 1)
axis(side = 1, col = "white", tcl = 0)
axis(side = 2)
axis(side = 2, col = "white", tcl = 0)
polygon(c(-15,-15,380,380),c(-45,0,0,-45),col=rgb(0.1, .4, .8,0.3))
#plot it!
plot(days, -depthLimit , type = "l", ylim = c(-40,5),
main = "Mysis light threshold",
ylab = "Depth from Surface",
xlab = "Day of Year")
#lines(days, -isocline)
axis(side = 1)
axis(side = 1, col = "white", tcl = 0)
axis(side = 2)
axis(side = 2, col = "white", tcl = 0)
polygon(c(-15,-15,380,380),c(-45,0,0,-45),col=rgb(0.1, .5, .85,0.3))
suface = as.list(rep(0, 365))
#plot it!
plot(days, -depthLimit , type = "l", ylim = c(-40,5),
main = "Mysis Light Threshold from Surface",
ylab = "Depth from Surface",
xlab = "Day of Year")
#lines(days, -isocline)
axis(side = 1)
axis(side = 1, col = "white", tcl = 0)
axis(side = 2)
axis(side = 2, col = "white", tcl = 0)
polygon(c(-15,-15,380,380),c(-45,0,0,-45),col=rgb(0.1, .5, .85,0.3))
#plot it!
plot(days, -depthLimit , type = "l", ylim = c(-40,5),
main = "Mysis Light Threshold from Surface",
ylab = "Depth from Surface",
xlab = "Day of Year")
#lines(days, -isocline)
axis(side = 1)
axis(side = 1, col = "white", tcl = 0)
axis(side = 2)
axis(side = 2, col = "white", tcl = 0)
#polygon(c(-15,-15,380,380),c(-45,0,0,-45),col=rgb(0.1, .5, .85,0.3))
plot(-depthData[seq(12, length(lightLevels), 24)], type = "l", width = 3, frame.plot=T,axes=FALSE,
main = "Depth of 10 degrees Centigrade from Surface",
xlab = "Day of Year",
ylab = "Depth from Water Surface")
axis(side = 1)
axis(side = 1, col = "white", tcl = 0)
axis(side = 2)
axis(side = 2, col = "white", tcl = 0)
